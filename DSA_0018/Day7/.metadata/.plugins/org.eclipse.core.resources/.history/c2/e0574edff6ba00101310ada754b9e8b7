package com.demo.linkedlists;

public class DoublyLinkedList {
	Node head;

	class Node {

		int data;
		Node next;
		Node prev;

		public Node(int val) {
			this.data = val;
			next = null;
			prev = null;
		}
	}

	public boolean addNodeAtLast(int value) {

		Node newNode = new Node(value);

		Node temp = head;
		Node prev = null;

		if (head == null) {
//			newNode.next = head.next;
			head = newNode;
			newNode.prev = head;
			return true;
		} else {
			while (temp.next != null) {
				prev = temp;
				temp = temp.next;
			}
			temp.next = newNode;
			newNode.prev = temp;

			return true;
		}
	}

	public boolean addNodeAtIindex(int pos, int v) {
		Node newNode = new Node(v);
		if (head == null) {
			head = newNode;
			return true;
		} else {
			if (pos == 1) {
				newNode.next = head;
				newNode.prev = head.prev;
				head.prev = newNode;
				head = newNode;
				return true;
			} else {
				Node temp = head;
				int j = 1;
				while (temp.next != null && j < pos - 1) {
					Node prev = temp;
					temp = temp.next;
					j++;
				}
				if (temp.next != null) {
					newNode.next = temp.next;
					newNode.prev = temp;
					temp.next = newNode;
				}
				if (newNode.next != null) {
					newNode.next.prev = newNode;
				}
				return true;
			}
		}
	}

	public boolean addNodeAfterValue(int num, int val) {
		Node newNode = new Node(val);
		Node temp = head;

		while (temp.data != num && temp != null) {
			temp = temp.next;
		}

		if (temp != null && temp.data == num) {
			newNode.next = temp.next;
			newNode.prev = temp;
			temp.next = newNode;
			if (temp.next != null)
				temp.next.prev = newNode; // newNode.next.prev = newNode;
		} else {
			return false;
		}
		return true;
	}

	public void display() {
		Node temp = head;
		while (temp != null) {
			System.out.print(temp.data + "---->");
			temp = temp.next;
		}
		System.out.println("null");
	}

	public boolean deleteNodeAti(int pos) {
		if (pos == 1) {
			head = head.next;
			head.prev = null;
		} else {
			Node temp = head;
			Node prev = temp;
			int i = 1;
			while (temp != null && i < pos) {
				prev = temp;
				temp = temp.next;
				i++;
			}
			if (temp != null) {
				prev.next = temp.next;
				temp.next = null;
				if (temp.next != null) {
					temp.next.prev = temp.prev;
					temp.prev = null;
				}
			}
			else {
				return false;
			}
		}

		return true;
	}

	public boolean deleteNodeByVal(int val) {
		Node temp = head;

		while (temp.data != val && temp != null) {
			temp = temp.next;
		}
		if (head.data == val) {
			head = head.next;
			temp.prev = null;
			head.next.prev = null;
			return true;
		} else if (temp != null && temp.data == val) {
			temp.prev.next = temp.next;
			if (temp.next != null) {
				temp.next.prev = temp.prev;
				temp.next = null;
			}
			temp.prev = null;
		} else {
			return false;
		}
		return true;
	}

	public void reverseLinkedList() {
		
		Node temp = head;
		Node tail = head;
		while(tail!=null) {
			tail = tail.next;
		}
		
		while(tail!=head) {
			System.out.println(tail.data+"--->");
			
		}
		
	}

}